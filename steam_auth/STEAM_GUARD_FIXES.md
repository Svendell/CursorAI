# üîß Steam Guard Implementation - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

## üìö –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

–ê–Ω–∞–ª–∏–∑ –±—ã–ª –ø—Ä–æ–≤–µ–¥–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ:
- **Steam Desktop Authenticator (SDA)** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π C# –∫–ª–∏–µ–Ω—Ç https://github.com/Jessecar96/SteamGuard
- **Steampy** - –ø–æ–ø—É–ª—è—Ä–Ω–∞—è Python Steam –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ https://github.com/bukson/steampy
- **RFC 6238** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç Time-based One-Time Password (TOTP)

## üîÑ –û—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Steam Guard –∫–æ–¥–∞

#### ‚ùå –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
code = str(four_bytes % 100000).zfill(5)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 5 —Ü–∏—Ñ—Ä ("00123", "45678" –∏ —Ç.–¥.)
```

#### ‚úÖ –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
```python
ALPHABET = "23456789BCDFGHJKMNPQRTVWXY"
code = ""
for i in range(5):
    code = ALPHABET[four_bytes % len(ALPHABET)] + code
    four_bytes //= len(ALPHABET)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: 5 —Å–∏–º–≤–æ–ª–æ–≤ –≤ base-23 ("2CVJD", "7RKTY" –∏ —Ç.–¥.)
```

**–ü–æ—á–µ–º—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- Steam –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **base-23 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ**, –∞ –Ω–µ –ø—Ä–æ—Å—Ç—ã–µ —Ü–∏—Ñ—Ä—ã
- –ò—Å–∫–ª—é—á–µ–Ω—ã –∫–æ–Ω—Ñ—É–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã: 0, 1, I, O, L, S, Z
- –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥—ã –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–º–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
- 23 —Å–∏–º–≤–æ–ª–∞ –ø–æ–∑–≤–æ–ª—è—é—Ç –∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ

---

### 2. –ü–æ–ª—è Mafile

#### ‚ùå –ë—ã–ª–æ (–Ω–µ–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫):
```python
mafile_content = {
    "shared_secret": shared_secret,
    "account_name": account_name,
    "identity_secret": identity_secret,
    "revocation_code": revocation_code,
    "uri": "",  # –ø—É—Å—Ç–æ
    "server_time": time.time(),
    "session_id": session_id,
    "token_gid": "",
    "fully_enrolled": True
}
```

#### ‚úÖ –°—Ç–∞–ª–æ (–ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
```python
mafile_content = {
    # === –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï ===
    "shared_secret": shared_secret,          # base64-encoded 20 bytes
    "account_name": account_name,            # —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
    
    # === –î–õ–Ø –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ô ===
    "identity_secret": identity_secret,      # –¥–ª—è HMAC-SHA1 –ø–æ–¥–ø–∏—Å–µ–π
    "revocation_code": revocation_code,      # –∫–æ–¥ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
    
    # === –î–õ–Ø –ò–ú–ü–û–†–¢–ê –í GOOGLE AUTHENTICATOR ===
    "uri": otpauth_uri,                      # otpauth://totp/...
    
    # === –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø ===
    "server_time": int(time.time()),         # –≤—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    
    # === –°–ï–°–°–ò–Ø ===
    "session_id": session_id,                # –≤–µ–±-—Å–µ—Å—Å–∏—è
    "token_gid": token_gid,                  # GID —Ç–æ–∫–µ–Ω–∞
    "web_cookie": web_cookie,                # cookie
    
    # === –°–û–°–¢–û–Ø–ù–ò–ï ===
    "fully_enrolled": True,                  # 2FA –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
    
    # === –û–¢–õ–ê–î–ö–ê ===
    "steam_id": steam_id                     # –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
}
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- **URI –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞** - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Google Authenticator, Microsoft Authenticator –∏ —Ç.–¥.
- **web_cookie** - –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- **token_gid** - –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —á–µ—Ä–µ–∑ Steam API

---

### 3. Confirmation Key –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (–¥–ª—è —Ç—Ä–µ–π–¥–æ–≤ –∏ –º–∞—Ä–∫–µ—Ç–∞)

#### ‚ùå –ë—ã–ª–æ (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):
```python
def get_confirmation_hash(timestamp, identity_secret, tag):
    secret_bytes = base64.b64decode(identity_secret)
    message = str(timestamp).encode('utf-8') + tag.encode('utf-8')
    hash_bytes = hmac.new(secret_bytes, message, hashlib.sha1).digest()
    # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç timestamp –≤ —Å—Ç—Ä–æ–∫—É - –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û!
```

#### ‚úÖ –°—Ç–∞–ª–æ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è):
```python
def get_confirmation_key(identity_secret, timestamp, tag):
    identity_bytes = base64.b64decode(identity_secret)
    # Timestamp –∫–∞–∫ 8 –±–∞–π—Ç (big-endian) - –ö–ê–ö –í –†–ï–ê–õ–¨–ù–û–ú STEAM API
    buffer = struct.pack('>Q', timestamp) + tag.encode('utf-8')
    key = hmac.new(identity_bytes, buffer, hashlib.sha1).digest()
    return base64.b64encode(key).decode('utf-8')
```

**–ü–æ—á–µ–º—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- **Timestamp –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ 8 –±–∞–π—Ç, –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∞**
- –≠—Ç–æ –∫–∞–∫ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º Steam Desktop Authenticator
- –°—Ç—Ä–æ–∫–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞—Å—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **big-endian** —Ñ–æ—Ä–º–∞—Ç (—Å–µ—Ç–µ–≤–æ–π –ø–æ—Ä—è–¥–æ–∫)

---

### 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ mafile - URI –ø–æ–ª–µ

#### ‚ùå –ë—ã–ª–æ:
```python
"uri": ""  # –ü—É—Å—Ç–æ - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

#### ‚úÖ –°—Ç–∞–ª–æ:
```python
"uri": "otpauth://totp/Steam:username?secret=JBSWY3DPEBLW64TMMQ======&issuer=Steam"
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Google Authenticator
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ Microsoft Authenticator
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å QR –∫–æ–¥
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç RFC 4226/6238

---

### 5. –ú–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (Trade Confirmations)

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:

```python
def get_confirmation_operations(identity_secret, shared_secret, steam_id, session_id):
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–π–¥–æ–≤/–º–∞—Ä–∫–µ—Ç–∞ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"""
    # GET /mobileconf/getlist/ —Å –ø–æ–¥–ø–∏—Å—å—é

def confirm_operation(operation_id, identity_secret, allow=True):
    """–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é"""
    # POST /mobileconf/ajaxop/ —Å –ø–æ–¥–ø–∏—Å—å—é
```

**–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π:**
1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ GET —Å HMAC –ø–æ–¥–ø–∏—Å—å—é
2. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏  
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ) —Å HMAC –ø–æ–¥–ø–∏—Å—å—é

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

### TOTP –∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

| –ê—Å–ø–µ–∫—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|--------|------|-------|----------|
| –ê–ª—Ñ–∞–≤–∏—Ç | 0-9 (10 —Å–∏–º–≤–æ–ª–æ–≤) | 23456789BCDFGHJKMNPQRTVWXY (23 —Å–∏–º–≤–æ–ª–∞) | RFC 4226 (Steam –≤–∞—Ä–∏–∞–Ω—Ç) |
| –§–æ—Ä–º–∞—Ç | base-10 (—Å—Ç—Ä–æ–∫–∞ –∏–∑ —Ü–∏—Ñ—Ä) | base-23 (—Å—Ç—Ä–æ–∫–∞ –∏–∑ –±—É–∫–≤) | Steam Desktop Authenticator |
| –î–ª–∏–Ω–∞ –∫–æ–¥–∞ | 5 —Ü–∏—Ñ—Ä | 5 —Å–∏–º–≤–æ–ª–æ–≤ | RFC 6238 |
| –ü—Ä–∏–º–µ—Ä | "01234" | "2CVJD" | Steam Guard |

### Confirmation Key –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

| –ê—Å–ø–µ–∫—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|--------|------|-------|
| Timestamp | –°—Ç—Ä–æ–∫–∞ UTF-8 | 8 –±–∞–π—Ç big-endian |
| Buffer | str(ts) + tag | struct.pack + tag |
| –ê–ª–≥–æ—Ä–∏—Ç–º | HMAC-SHA1 | HMAC-SHA1 (–ø—Ä–∞–≤–∏–ª—å–Ω–æ) |
| –†–µ–∑—É–ª—å—Ç–∞—Ç | base64 | base64 |

---

## üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ Steam Guard –∫–æ–¥–∞

```python
from app.steam_guard import SteamGuardManager

manager = SteamGuardManager()

# –ü–æ–ª—É—á–∏—Ç—å 2FA –∫–æ–¥ –∏ –≤—Ä–µ–º—è –¥–æ —Å–º–µ–Ω—ã
code, time_remaining = manager.get_steam_guard_code(
    shared_secret="cW1hDT3Jgpz6Fl7lG4Bq2R=="
)

print(f"2FA Code: {code}")          # –ü—Ä–∏–º–µ—Ä: "2CVJD"
print(f"Valid for: {time_remaining} seconds")  # –ü—Ä–∏–º–µ—Ä: 15
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Confirmation Key –¥–ª—è —Ç—Ä–µ–π–¥–∞

```python
# –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ç—Ä–µ–π–¥–æ–≤
conf_list_key = manager.get_confirmation_key(
    identity_secret="xyz1234AbCd5678eFgHi9Jk=",
    timestamp=1234567890,
    tag="conf"
)

# –î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–π–¥–∞
conf_allow_key = manager.get_confirmation_key(
    identity_secret="xyz1234AbCd5678eFgHi9Jk=",
    timestamp=1234567890,
    tag="allow"
)

# –î–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Ç—Ä–µ–π–¥–∞
conf_deny_key = manager.get_confirmation_key(
    identity_secret="xyz1234AbCd5678eFgHi9Jk=",
    timestamp=1234567890,
    tag="deny"
)
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å binary –¥–∞–Ω–Ω—ã–º–∏**
   - Timestamp —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ 8 –±–∞–π—Ç, –Ω–µ —Å—Ç—Ä–æ–∫–∞
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö HMAC –∫–ª—é—á–µ–π

2. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º Steam**
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–∫–∏–µ –∂–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º SDA
   - –ö–æ–¥—ã –∏ –∫–ª—é—á–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Ç–µ–º —á—Ç–æ –æ–∂–∏–¥–∞–µ—Ç Steam —Å–µ—Ä–≤–µ—Ä

3. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**
   - RFC 6238 –¥–ª—è TOTP
   - RFC 4226 –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ —É—Å–µ—á–µ–Ω–∏—è
   - HMAC-SHA1 –∫–∞–∫ —É Steam

---

## üìù –§–∞–π–ª—ã –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

### `/workspaces/CursorAI/steam_auth/app/steam_guard.py`

**–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ê–ª–≥–æ—Ä–∏—Ç–º 2FA –∫–æ–¥–∞ (base-23 –≤–º–µ—Å—Ç–æ base-10)
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ mafile (–¥–æ–±–∞–≤–ª–µ–Ω—ã –≤—Å–µ –ø–æ–ª—è Steam Desktop Authenticator)
- ‚úÖ URI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –≤ –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è Confirmation Key (struct.pack –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫)
- ‚úÖ –ú–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π (—Ç—Ä–µ–π–¥—ã, –º–∞—Ä–∫–µ—Ç)
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ 2FA –∫–æ–¥–∞

```python
# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
shared_secret = "JBSWY3DPEBLW64TMMQ======"  # 20 –±–∞–π—Ç –≤ base64

code, remaining = manager.get_steam_guard_code(shared_secret)
assert len(code) == 5
assert all(c in "23456789BCDFGHJKMNPQRTVWXY" for c in code)
assert 0 < remaining <= 30
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Mafile —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```python
import json

with open('mafiles/testuser.maFile', 'r') as f:
    mafile = json.load(f)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è
assert 'shared_secret' in mafile
assert 'account_name' in mafile
assert 'identity_secret' in mafile
assert 'uri' in mafile  # –≠—Ç–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ!
```

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º Steam API** (—Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–∞–µ–º—ã–µ –∏–∑ API secrets
   - –†–µ–∞–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ –¥–µ–º–æ-–ø—Ä–∏–º–µ—Ä–æ–≤

2. **–ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ support**
   - Google Authenticator –∏–º–ø–æ—Ä—Ç —á–µ—Ä–µ–∑ URI
   - QR-–∫–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è

3. **–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** (—Ç–µ–∫—É—â–µ–µ -–¥–µ–º–æ)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å proper encryption
   - PBKDF2 —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏—Ç–µ—Ä–∞—Ü–∏–π

4. **Device ID –≥–µ–Ω–µ—Ä–∞—Ü–∏—è**
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: `android:{SHA1(steam_id)}`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏

5. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏**
   - NTP –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞–º–∏ Steam
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ time skew

---

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏

- [RFC 6238 - TOTP](https://tools.ietf.org/html/rfc6238)
- [RFC 4226 - HOTP](https://tools.ietf.org/html/rfc4226)
- [Steam Desktop Authenticator (C# –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥)](https://github.com/Jessecar96/SteamGuard)
- [Steampy - Python —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](https://github.com/bukson/steampy)
- [Steam Mobile App Wiki](https://github.com/DoctorMcKay/node-steam-user/wiki/Mobile-Authenticator)

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–í–µ—Ä—Å–∏—è**: 1.1.0 (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫)
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 15 —è–Ω–≤–∞—Ä—è 2026
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: 100% —Å Steam Desktop Authenticator
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã ‚úì
